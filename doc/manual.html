<html>
	<head>
		<title>SimpleRTS Manual</title>
		<style>
			.definition {
				padding-left: 2em;
				display: block;
			}
		</style>
	</head>
	<body>
		<h1>SimpleRTS Manual</h1>
		<h4>version 1.0</h4>
		<hr/>
		<h2>Table of Contents</h2>
		<ol>
			<li><a href="#Introduction">Introduction</a></li>
			<li><a href="#Revisions">Revision History</a></li>
			<li><a href="#Run">How to Run</a></li>
			<li><a href="#Config">Configuration</a>
			<li><a href="#Agent">Writing An Agent</a>
			<li><a href="#ScripAgent">Using The Scripted Agent</a>
			<li><a href="#Engine">The Engine</a>
			<li><a href="#Contact">Contact Info</a></li>
		</ol>
		<h2 id="Introduction">1. Introduction</h2>
		<p>SimpleRTS is an open source project developed by Tim Ernsberger, 
		Scott Sosnowski, and Feng Cao, under the advisement of Soumya Ray.
		The purpose of this project is to provide a simple but sophisticated
		test bench for use in testing artificially intelligent agents. SimpleRTS
		is based on <a href="http://stratagus.sourceforge.net/">Stratagus</a>,
		but does not include sophisticated graphics or sound, making it an ideal
		platform for running large numbers of simulations quickly.
		</p>
		<h2 id="Revisions">2. Revision History</h2>
		<h4>1.0.0</h4>
		<p>This is the first version of SimpleRTS. New versions will be published
		   as bugs are resolved and as additional features are added.
		</p>
		<h2 id="Run">3. How to Run</h2>
		<p>Note: this section describes how to run SimpleRTS from a Jar file. If you wish to
		   use the source code, you will have to figure that out on your own. If you do choose
		   to recompile from source you will need a copy of Google's 
		   <a href="http://code.google.com/p/guava-libraries/">Guava library</a>.
		</p>
		<p>The basic command for running SimpleRTS is: 
		</p>
		<code>java -cp SimpleRTS.jar edu.cwru.SimpleRTS.Main &lt;map file&gt; </code>
		<p>This will invoke the main() method in edu.cwru.SimpleRTS.Main. In order to run
		   a simulation, you will need to supply some arguments. Entering in insufficient
		   or incorrect arguments will cause the program to print out usage info and
		   terminate. Here are all the options that can be used:
		</p>
		<div><code>--config <i>&lt;XML configuration file&gt;</code></i>
			<div class="definition">These two arguments specify that you want to import
			    a configuration and which file to read to get it. This is an optional
			    parameter. If not specified, the program will use the last configuration
			    with which it was run or default values if no configuration data has been
			    provided previously.
			</div>
		</div>
		<div><code>--agent <i>&lt;agent class&gt; &lt;playernum&gt;</i></code>
			<div class="definition">Indicates that the agent defined by 
			    <i>&lt;agent class&gt;</i> should be used in this simulation. The full
			    path to the class must be specified (e.g. edu.cwru.SimpleRTS.SimpleAgent1).
			    By default, the program will use a single argument constructor that takes
			    in an int that represents playernum. The <i>&lt;playernum&gt;</i> parameter 
			    definies an ID with which the agent will be associated. 
			    <strong>At least one instance of this option is required.</strong>
			</div>
		</div>
		<div><code>--agentparam <i>&lt;string param&gt;</i></code>
			<div class="definition">Follows an --agent, allowing complex classes to have additional
			parameters.  Each is a string.
			</div>
		</div>
		<div><code>--loadfrom <i>&lt;serialized agent file name&gt;</i></code>
			<div class="definition">This option can only be used immediately following
			    the previous option. If used, the agent specified by the preceeding 
			    --agent option will be loaded from the file instead of being constructed.
			    This option assumes that the data in the file is a serialized representation
			    of an agent. 			    
			</div> 
		</div>
		<h2 id="Config">4. Configuration</h2>
		<p>The configuration file is an XML file that gets loaded into the user-specific
		   instance of <a href="http://download.oracle.com/javase/6/docs/api/java/util/prefs/Preferences.html">
		   java.util.Preferences</a>. Basically, the configuration file is a hierarchy of
		   maps which store primitives as values. For an example of how to write a configuration
		   file, see <a href="../data.defaultConfig.xml">data/defaultConfig.xml</a>. For an example
		   of how to define and export preferences in Java code, see 
		   edu.cwru.SimpleRTS.util.DefaultConfigurationGenerator.java. Here are the values that SimpleRTS
		   uses and their defaults:
		</p>
		<ul>
			<li>edu
				<ul>
					<li>cwru
						<ul>
							<li>SimpleRTS
								<ul>
									<li>environment
										<ul>
											<li><strong>NumEpisodes</strong> - the number of episodes to run (default 1)</li>
											<li><strong>EpisodesPerSave</strong> - how often to save the terminal state and agents (default 0, i.e. never)</li>
											<li><strong>SaveAgents</strong> - whether to save the agents periodically (only applies if EpisodesPerSave > 0; default false)</li>
										</ul>
									</li>
									<li>model
										<ul>
											<li><strong>Conquest</strong> - agents must eliminate all other agents to win (default false)</li>
											<li><strong>Midas</strong> - agents must gather RequiredGold and RequiredWood amounts of gold and wood to win (default false)</li>
											<li><strong>ManifestDestiny</strong> - agents must build specified quantities of units to win (default false)</li>
											<li><strong>TimeLimit</strong> - agents must complete other goals within this amount of turns to win (default Integer.MAX_VALUE)</li>
											<li><strong>RequiredGold</strong> - amount of gold required for Midas victory (default 0)</li>
											<li><strong>RequiredWood</strong> - amount of wood required for Midas victory (default 0)</li>
											<li><strong>Required<i>unitTemplateName</i>Player<i>playerId</i></strong> - number of instances of <i>unitTemplateName</i> required for the <i>playerId</i>th agent to win by ManifestDestiny (default 0)</li>
										</ul>	
								</ul>
							</li>
						</ul>
					</li>
				</ul>
			</li>
		</ul>
		<p>You can use the configuration file to define	parameters for your own agent 
			(e.g. learning rate, discount factor, etc.). Just define your own path, figure out 
			how to use java.util.Preferences, and put your settings in the configuration file.
		</p>
		<p><strong>Note:</strong> preferences do not get cleared out automatically; they are
			persisted to disk by Java and reloaded for every Java program run by the same
			user on the same machine. SimpleRTS clears out the properties defined above
			automatically, but you will have to clear out custom properties yourself.
		</p>
		<h2 id="Agent">5. Writing an Agent</h2>
		<p>All agents written to interact with SimpleRTS must extend the class
		    <code>edu.cwru.SimpleRTS.agent.Agent</code>. Consult the javadoc for a
			description of the methods in Agent. At the very least, you must implement
			the initialStep(), middleStep(), and terminalStep() methods. These three
			methods define the logic for the agent to receive a state update and return
			a mapping of its units to actions for the next step.
		</p>
		<h2 id="Agent">6. Using the Scripted Agent</h2>
		<p>The scripted agent may be found at <code>edu.cwru.SimpleRTS.agent.ScriptedGoalAgent</code>.
			It's constructor requires a BufferedReader, which may be connected to a file, the standard in, or a string (via calling <code>java.io.BufferedReader</code>'s constructor with an argument of a <code>java.io.FileReader</code>, <code>java.io.InputStreamReader</code>, or <code>java.io.StringReader</code>, respectively).
			The input must be in the form of a series of commands separated by new lines.
			The commands are executed sequentially, with execution waiting on any command 
			whose preconditions are not met.  If multiple commands can be executed during
			the same time step, they will be.  Commands may be suffixed by // followed by 
			a comment, but there should be no spaces before the //.	The command sequence
			 may be terminated with a line saying containing only "END" (but not including
			 the quotation marks).  This is not necessary unless the command sequence comes
			  from standard in.
			<br> <br>
			The script may take actions of Transfer, Build, Produce, Wait, and Attack.  These 
			commands are put in with their arguments separated by colons. <br>
			Transfer changes the jobs of a selected number of peasants from one selected task to
			another selected task. The tasks available are Wood, Gold, and Idle<br>
			As an example, "Transfer:1:Idle:Gold" takes 1 peasant and reassigns it to gold mining.
			<br>
			Build uses an idle peasant to build a selected building type in roughly a selected 
			position.  This position is relative to the average position of units at the start
			of each episode.  If that position is occupied, it will find the closest unoccupied
			position and build there.  If no peasant that can build the building is idle and not
			doing other building, then the command will not be executed until there is one, so it is
			advised that Transfer be used first to make a peasant idle.<br>
			As an example, "Build:Farm:-2:2" builds a farm at a position offset from the starting point
			by -2 in the x direction and +2 in the y direction.<br>
			<br>
			Produce uses a building able to produce a selected unit type.  If no building is both capable
			of producing that unit and is not already producing something, then the command will not be executed
			until one is available.<br>
			As an example, "Produce:Peasant" orders that a town hall make a peasant. <br>
			<br>
			Wait allows execution to wait a selected resources reaches a selected amount.  While
			Produce and Build do this automatically, it can be useful to wait until resources accrue
			before Transferring a peasant from that resource to Idle, so that it can be used to build. <br>
			As an example, "Wait:Gold:400" waits until you have a total of 400 gold.<br>
			<br>
			Attack sends all military units to attack the enemy.  The attack walks toward the enemy town hall 
			(or lacking a town hall, some other enemy unit) and attacks that gets in range on the way. Attack:All
			does the same thing with everything, including peasants. 
			As an example, "Attack" attacks with military units, "Attack:All" does the same with every unit.<br>
			<br>
			Note on usage: Many commands have preconditions that are difficult to satisfy, so take
			care choosing commands in your script and note that the scripted agent is not robust in
			the face of interference (such as destroying production buildings).<br>
			<br>
			Finally, as a full example of a working script:<br>
			Build:TownHall:0:0//use your starting peasant to build a town hall<br>
			Transfer:1:Idle:Gold//make the builder gather gold<br>
			Wait:Gold:500//wait until you have enough gold for a farm<br>
			Transfer:1:Gold:Wood//make him gather wood<br>
			Wait:Wood:250//until you have enough wood too<br>
			Transfer:1:Wood:Idle//then free him up<br>
			Build:Farm:-2:2//make him build a farm<br>
			Transfer:1:Idle:Gold//make him go back to gold<br>
			Produce:Peasant//make a peasant when you can<br>
			Transfer:1:Idle:Wood//and put the new guy on woodcutting<br>
			Produce:Peasant//make another peasant when you can<br>
			Transfer:1:Idle:Gold//and put the new guy on gold<br>
			Produce:Peasant//and make another<br>
			Transfer:1:Idle:Gold//and put that one on gold too<br>
			Wait:Wood:400//when you have enough wood for a barracks<br>
			Transfer:1:Wood:Idle//free up the woodcutter to build<br>
			Build:Barracks:2:-2//build a barracks<br>
			Transfer:1:Idle:Gold//make the builder go to gold<br>
			Produce:Footman//make a footman<br>
			Attack:All<br>
			
		</p>
		<h2 id="Engine">The Engine</h2>
		<p>The following is a simple overview of the engine.
		</p>
		<h2 id="Contact">Contact Info</h2>
		<p>For questions about running simulations, contact Tim Ernsberger at 
			<a href="maito:tse6@case.edu">tse6@case.edu</a>.
		</p>
		<p>For questions about game mechanics, contact Scott Sosnowski at
			<a href="mailto:sts12@case.edu">sts12@case.edu</a>.
		</p>private
		<p>For questions about homework assignments involving SimpleRTS, contact
			Feng Cao at <a href="mailto:fxc100@case.edu">fxc100@case.edu</a>.
		</p>
	</body>
</html>
